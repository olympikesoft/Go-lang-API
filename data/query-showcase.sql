SELECT a.comparison_key, COALESCE(a.name, '') as name, a.ranking, a.description, a.url, a.duration, a.thumb, pr.name provider, c.id category, p.price FROM activities a JOIN (SELECT DISTINCT comparison_key FROM activities ac ORDER BY ac.ranking LIMIT 4) as ck ON ck.comparison_key = a.comparison_key JOIN cities ci ON a.city_id = ci.id  JOIN providers pr ON a.provider_id = pr.id  JOIN pricetables p ON a.id = p.activity_id  JOIN activities_categories ac ON a.id = ac.activity_id  JOIN categories c ON c.id = ac.category_id  JOIN activities_identities ai ON a.id = ai.activity_id  JOIN identities i ON i.id = ai.identity_id  JOIN activities_primary_tags apt ON a.id = apt.activity_id  JOIN primary_tags pt ON pt.id = apt.primary_tag_id  WHERE ci.id = 1 AND p.currency = 'EUR' GROUP BY a.id,c.id,p.price  ORDER by a.ranking, p.price, pr.ranking, a.duration